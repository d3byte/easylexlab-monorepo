{"version":3,"sources":["../../../../../server/app/libs/jquery/flot/jquery.flot.pie.js"],"names":["$","REDRAW_ATTEMPTS","REDRAW_SHRINK","init","plot","canvas","target","options","maxRadius","centerLeft","centerTop","processed","ctx","highlights","hooks","processOptions","push","series","pie","show","grid","label","legend","radius","tilt","bindEvents","eventHolder","getOptions","hoverable","unbind","mousemove","onMouseMove","clickable","click","onClick","processDatapoints","data","datapoints","drawOverlay","octx","draw","newCtx","getCanvas","parent","setData","combine","getData","total","combined","numCombined","color","newdata","i","length","value","isArray","isNaN","parseFloat","isFinite","threshold","extend","angle","Math","PI","percent","canvasWidth","getPlaceholder","width","canvasHeight","height","legendWidth","children","filter","min","offset","top","left","position","match","slices","attempts","clear","drawShadow","drawPie","prepend","setSeries","insertLegend","clearRect","remove","shadowLeft","shadow","shadowTop","edge","alpha","save","translate","globalAlpha","fillStyle","scale","beginPath","arc","fill","restore","startAngle","currentAngle","drawSlice","stroke","lineWidth","drawDonutHole","drawLabels","strokeStyle","lineJoin","abs","moveTo","closePath","drawLabel","slice","index","lf","labelFormatter","text","plf","formatter","halfAngle","x","round","cos","y","sin","html","append","labelTop","labelLeft","css","background","opacity","c","pos","insertBefore","layer","innerRadius","globalCompositeOperation","isPointInPoly","poly","pt","l","j","findNearbySlice","mouseX","mouseY","s","isPointInPath","datapoint","dataIndex","seriesIndex","p1X","p1Y","p2X","p2Y","p3X","p3Y","p4X","p4Y","p5X","p5Y","arrPoly","arrPoint","e","triggerClickHoverEvent","eventname","canvasX","parseInt","pageX","canvasY","pageY","item","autoHighlight","h","auto","unhighlight","highlight","trigger","indexOfHighlight","triggerRedrawOverlay","splice","drawHighlight","plugins","name","version","jQuery"],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA,CAAC,UAASA,CAAT,EAAY;;AAEZ;;AAEA,KAAIC,kBAAkB,EAAtB;;AAEA;;AAEA,KAAIC,gBAAgB,IAApB;;AAEA,UAASC,IAAT,CAAcC,IAAd,EAAoB;;AAEnB,MAAIC,SAAS,IAAb;AAAA,MACCC,SAAS,IADV;AAAA,MAECC,UAAU,IAFX;AAAA,MAGCC,YAAY,IAHb;AAAA,MAICC,aAAa,IAJd;AAAA,MAKCC,YAAY,IALb;AAAA,MAMCC,YAAY,KANb;AAAA,MAOCC,MAAM,IAPP;;AASA;;AAEA,MAAIC,aAAa,EAAjB;;AAEA;;AAEAT,OAAKU,KAAL,CAAWC,cAAX,CAA0BC,IAA1B,CAA+B,UAASZ,IAAT,EAAeG,OAAf,EAAwB;AACtD,OAAIA,QAAQU,MAAR,CAAeC,GAAf,CAAmBC,IAAvB,EAA6B;;AAE5BZ,YAAQa,IAAR,CAAaD,IAAb,GAAoB,KAApB;;AAEA;;AAEA,QAAIZ,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBF,IAAzB,IAAiC,MAArC,EAA6C;AAC5C,SAAIZ,QAAQe,MAAR,CAAeH,IAAnB,EAAyB;AACxBZ,cAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBF,IAAzB,GAAgC,KAAhC;AACA,MAFD,MAEO;AACNZ,cAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBF,IAAzB,GAAgC,IAAhC;AACA;AACD;;AAED;;AAEA,QAAIZ,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnB,IAA6B,MAAjC,EAAyC;AACxC,SAAIhB,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBF,IAA7B,EAAmC;AAClCZ,cAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnB,GAA4B,IAAE,CAA9B;AACA,MAFD,MAEO;AACNhB,cAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnB,GAA4B,CAA5B;AACA;AACD;;AAED;;AAEA,QAAIhB,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAnB,GAA0B,CAA9B,EAAiC;AAChCjB,aAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAnB,GAA0B,CAA1B;AACA,KAFD,MAEO,IAAIjB,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAnB,GAA0B,CAA9B,EAAiC;AACvCjB,aAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAnB,GAA0B,CAA1B;AACA;AACD;AACD,GAjCD;;AAmCApB,OAAKU,KAAL,CAAWW,UAAX,CAAsBT,IAAtB,CAA2B,UAASZ,IAAT,EAAesB,WAAf,EAA4B;AACtD,OAAInB,UAAUH,KAAKuB,UAAL,EAAd;AACA,OAAIpB,QAAQU,MAAR,CAAeC,GAAf,CAAmBC,IAAvB,EAA6B;AAC5B,QAAIZ,QAAQa,IAAR,CAAaQ,SAAjB,EAA4B;AAC3BF,iBAAYG,MAAZ,CAAmB,WAAnB,EAAgCC,SAAhC,CAA0CC,WAA1C;AACA;AACD,QAAIxB,QAAQa,IAAR,CAAaY,SAAjB,EAA4B;AAC3BN,iBAAYG,MAAZ,CAAmB,OAAnB,EAA4BI,KAA5B,CAAkCC,OAAlC;AACA;AACD;AACD,GAVD;;AAYA9B,OAAKU,KAAL,CAAWqB,iBAAX,CAA6BnB,IAA7B,CAAkC,UAASZ,IAAT,EAAea,MAAf,EAAuBmB,IAAvB,EAA6BC,UAA7B,EAAyC;AAC1E,OAAI9B,UAAUH,KAAKuB,UAAL,EAAd;AACA,OAAIpB,QAAQU,MAAR,CAAeC,GAAf,CAAmBC,IAAvB,EAA6B;AAC5BgB,sBAAkB/B,IAAlB,EAAwBa,MAAxB,EAAgCmB,IAAhC,EAAsCC,UAAtC;AACA;AACD,GALD;;AAOAjC,OAAKU,KAAL,CAAWwB,WAAX,CAAuBtB,IAAvB,CAA4B,UAASZ,IAAT,EAAemC,IAAf,EAAqB;AAChD,OAAIhC,UAAUH,KAAKuB,UAAL,EAAd;AACA,OAAIpB,QAAQU,MAAR,CAAeC,GAAf,CAAmBC,IAAvB,EAA6B;AAC5BmB,gBAAYlC,IAAZ,EAAkBmC,IAAlB;AACA;AACD,GALD;;AAOAnC,OAAKU,KAAL,CAAW0B,IAAX,CAAgBxB,IAAhB,CAAqB,UAASZ,IAAT,EAAeqC,MAAf,EAAuB;AAC3C,OAAIlC,UAAUH,KAAKuB,UAAL,EAAd;AACA,OAAIpB,QAAQU,MAAR,CAAeC,GAAf,CAAmBC,IAAvB,EAA6B;AAC5BqB,SAAKpC,IAAL,EAAWqC,MAAX;AACA;AACD,GALD;;AAOA,WAASN,iBAAT,CAA2B/B,IAA3B,EAAiCa,MAAjC,EAAyCoB,UAAzC,EAAqD;AACpD,OAAI,CAAC1B,SAAL,EAAgB;AACfA,gBAAY,IAAZ;AACAN,aAASD,KAAKsC,SAAL,EAAT;AACApC,aAASN,EAAEK,MAAF,EAAUsC,MAAV,EAAT;AACApC,cAAUH,KAAKuB,UAAL,EAAV;AACAvB,SAAKwC,OAAL,CAAaC,QAAQzC,KAAK0C,OAAL,EAAR,CAAb;AACA;AACD;;AAED,WAASD,OAAT,CAAiBT,IAAjB,EAAuB;;AAEtB,OAAIW,QAAQ,CAAZ;AAAA,OACCC,WAAW,CADZ;AAAA,OAECC,cAAc,CAFf;AAAA,OAGCC,QAAQ3C,QAAQU,MAAR,CAAeC,GAAf,CAAmB2B,OAAnB,CAA2BK,KAHpC;AAAA,OAICC,UAAU,EAJX;;AAMA;;AAEA,QAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIhB,KAAKiB,MAAzB,EAAiC,EAAED,CAAnC,EAAsC;;AAErC,QAAIE,QAAQlB,KAAKgB,CAAL,EAAQhB,IAApB;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,QAAIpC,EAAEuD,OAAF,CAAUD,KAAV,KAAoBA,MAAMD,MAAN,IAAgB,CAAxC,EAA2C;AACvCC,aAAQA,MAAM,CAAN,CAAR;AACH;;AAED,QAAItD,EAAEuD,OAAF,CAAUD,KAAV,CAAJ,EAAsB;AACrB;AACA,SAAI,CAACE,MAAMC,WAAWH,MAAM,CAAN,CAAX,CAAN,CAAD,IAAgCI,SAASJ,MAAM,CAAN,CAAT,CAApC,EAAwD;AACvDA,YAAM,CAAN,IAAW,CAACA,MAAM,CAAN,CAAZ;AACA,MAFD,MAEO;AACNA,YAAM,CAAN,IAAW,CAAX;AACA;AACD,KAPD,MAOO,IAAI,CAACE,MAAMC,WAAWH,KAAX,CAAN,CAAD,IAA6BI,SAASJ,KAAT,CAAjC,EAAkD;AACxDA,aAAQ,CAAC,CAAD,EAAI,CAACA,KAAL,CAAR;AACA,KAFM,MAEA;AACNA,aAAQ,CAAC,CAAD,EAAI,CAAJ,CAAR;AACA;;AAEDlB,SAAKgB,CAAL,EAAQhB,IAAR,GAAe,CAACkB,KAAD,CAAf;AACA;;AAED;;AAEA,QAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIhB,KAAKiB,MAAzB,EAAiC,EAAED,CAAnC,EAAsC;AACrCL,aAASX,KAAKgB,CAAL,EAAQhB,IAAR,CAAa,CAAb,EAAgB,CAAhB,CAAT;AACA;;AAED;AACA;;AAEA,QAAK,IAAIgB,IAAI,CAAb,EAAgBA,IAAIhB,KAAKiB,MAAzB,EAAiC,EAAED,CAAnC,EAAsC;AACrC,QAAIE,QAAQlB,KAAKgB,CAAL,EAAQhB,IAAR,CAAa,CAAb,EAAgB,CAAhB,CAAZ;AACA,QAAIkB,QAAQP,KAAR,IAAiBxC,QAAQU,MAAR,CAAeC,GAAf,CAAmB2B,OAAnB,CAA2Bc,SAAhD,EAA2D;AAC1DX,iBAAYM,KAAZ;AACAL;AACA,SAAI,CAACC,KAAL,EAAY;AACXA,cAAQd,KAAKgB,CAAL,EAAQF,KAAhB;AACA;AACD;AACD;;AAED,QAAK,IAAIE,IAAI,CAAb,EAAgBA,IAAIhB,KAAKiB,MAAzB,EAAiC,EAAED,CAAnC,EAAsC;AACrC,QAAIE,QAAQlB,KAAKgB,CAAL,EAAQhB,IAAR,CAAa,CAAb,EAAgB,CAAhB,CAAZ;AACA,QAAIa,cAAc,CAAd,IAAmBK,QAAQP,KAAR,GAAgBxC,QAAQU,MAAR,CAAeC,GAAf,CAAmB2B,OAAnB,CAA2Bc,SAAlE,EAA6E;AAC5ER,aAAQnC,IAAR,CACChB,EAAE4D,MAAF,CAASxB,KAAKgB,CAAL,CAAT,EAAkB,EAAM;;AAEvBhB,YAAM,CAAC,CAAC,CAAD,EAAIkB,KAAJ,CAAD,CAFW;AAGjBJ,aAAOd,KAAKgB,CAAL,EAAQF,KAHE;AAIjB7B,aAAOe,KAAKgB,CAAL,EAAQ/B,KAJE;AAKjBwC,aAAOP,QAAQQ,KAAKC,EAAb,GAAkB,CAAlB,GAAsBhB,KALZ;AAMjBiB,eAASV,SAASP,QAAQ,GAAjB;AANQ,MAAlB,CADD;AAUA;AACD;;AAED,OAAIE,cAAc,CAAlB,EAAqB;AACpBE,YAAQnC,IAAR,CAAa;AACZoB,WAAM,CAAC,CAAC,CAAD,EAAIY,QAAJ,CAAD,CADM;AAEZE,YAAOA,KAFK;AAGZ7B,YAAOd,QAAQU,MAAR,CAAeC,GAAf,CAAmB2B,OAAnB,CAA2BxB,KAHtB;AAIZwC,YAAOb,WAAWc,KAAKC,EAAhB,GAAqB,CAArB,GAAyBhB,KAJpB;AAKZiB,cAAShB,YAAYD,QAAQ,GAApB;AALG,KAAb;AAOA;;AAED,UAAOI,OAAP;AACA;;AAED,WAASX,IAAT,CAAcpC,IAAd,EAAoBqC,MAApB,EAA4B;;AAE3B,OAAI,CAACnC,MAAL,EAAa;AACZ,WADY,CACJ;AACR;;AAED,OAAI2D,cAAc7D,KAAK8D,cAAL,GAAsBC,KAAtB,EAAlB;AAAA,OACCC,eAAehE,KAAK8D,cAAL,GAAsBG,MAAtB,EADhB;AAAA,OAECC,cAAchE,OAAOiE,QAAP,GAAkBC,MAAlB,CAAyB,SAAzB,EAAoCD,QAApC,GAA+CJ,KAA/C,MAA0D,CAFzE;;AAIAvD,SAAM6B,MAAN;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA9B,eAAY,KAAZ;;AAEA;;AAEAH,eAAasD,KAAKW,GAAL,CAASR,WAAT,EAAsBG,eAAe7D,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAxD,IAAgE,CAA7E;AACAd,eAAY0D,eAAe,CAAf,GAAmB7D,QAAQU,MAAR,CAAeC,GAAf,CAAmBwD,MAAnB,CAA0BC,GAAzD;AACAlE,gBAAawD,cAAc,CAA3B;;AAEA,OAAI1D,QAAQU,MAAR,CAAeC,GAAf,CAAmBwD,MAAnB,CAA0BE,IAA1B,IAAkC,MAAtC,EAA8C;AAC7C,QAAIrE,QAAQe,MAAR,CAAeuD,QAAf,CAAwBC,KAAxB,CAA8B,GAA9B,CAAJ,EAAwC;AACvCrE,mBAAc6D,cAAc,CAA5B;AACA,KAFD,MAEO;AACN7D,mBAAc6D,cAAc,CAA5B;AACA;AACD,QAAI7D,aAAaD,SAAjB,EAA4B;AAC3BC,kBAAaD,SAAb;AACA,KAFD,MAEO,IAAIC,aAAawD,cAAczD,SAA/B,EAA0C;AAChDC,kBAAawD,cAAczD,SAA3B;AACA;AACD,IAXD,MAWO;AACNC,kBAAcF,QAAQU,MAAR,CAAeC,GAAf,CAAmBwD,MAAnB,CAA0BE,IAAxC;AACA;;AAED,OAAIG,SAAS3E,KAAK0C,OAAL,EAAb;AAAA,OACCkC,WAAW,CADZ;;AAGA;AACA;;AAEA,MAAG;AACF,QAAIA,WAAW,CAAf,EAAkB;AACjBxE,kBAAaN,aAAb;AACA;AACD8E,gBAAY,CAAZ;AACAC;AACA,QAAI1E,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAnB,IAA2B,GAA/B,EAAoC;AACnC0D;AACA;AACD,IATD,QASS,CAACC,SAAD,IAAcH,WAAW/E,eATlC;;AAWA,OAAI+E,YAAY/E,eAAhB,EAAiC;AAChCgF;AACA3E,WAAO8E,OAAP,CAAe,iFAAf;AACA;;AAED,OAAIhF,KAAKiF,SAAL,IAAkBjF,KAAKkF,YAA3B,EAAyC;AACxClF,SAAKiF,SAAL,CAAeN,MAAf;AACA3E,SAAKkF,YAAL;AACA;;AAED;;AAEA,YAASL,KAAT,GAAiB;AAChBrE,QAAI2E,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoBtB,WAApB,EAAiCG,YAAjC;AACA9D,WAAOiE,QAAP,GAAkBC,MAAlB,CAAyB,gCAAzB,EAA2DgB,MAA3D;AACA;;AAED,YAASN,UAAT,GAAsB;;AAErB,QAAIO,aAAalF,QAAQU,MAAR,CAAeC,GAAf,CAAmBwE,MAAnB,CAA0Bd,IAA3C;AACA,QAAIe,YAAYpF,QAAQU,MAAR,CAAeC,GAAf,CAAmBwE,MAAnB,CAA0Bf,GAA1C;AACA,QAAIiB,OAAO,EAAX;AACA,QAAIC,QAAQtF,QAAQU,MAAR,CAAeC,GAAf,CAAmBwE,MAAnB,CAA0BG,KAAtC;AACA,QAAItE,SAAShB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnB,GAA4B,CAA5B,GAAgChB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnD,GAA4Df,YAAYD,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAxG;;AAEA,QAAIA,UAAU0C,cAAc,CAAd,GAAkBwB,UAA5B,IAA0ClE,SAAShB,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAA5B,IAAoC4C,eAAe,CAAf,GAAmBuB,SAAjG,IAA8GpE,UAAUqE,IAA5H,EAAkI;AACjI,YADiI,CACzH;AACR;;AAEDhF,QAAIkF,IAAJ;AACAlF,QAAImF,SAAJ,CAAcN,UAAd,EAAyBE,SAAzB;AACA/E,QAAIoF,WAAJ,GAAkBH,KAAlB;AACAjF,QAAIqF,SAAJ,GAAgB,MAAhB;;AAEA;;AAEArF,QAAImF,SAAJ,CAActF,UAAd,EAAyBC,SAAzB;AACAE,QAAIsF,KAAJ,CAAU,CAAV,EAAa3F,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAhC;;AAEA;;AAEA,SAAK,IAAI4B,IAAI,CAAb,EAAgBA,KAAKwC,IAArB,EAA2BxC,GAA3B,EAAgC;AAC/BxC,SAAIuF,SAAJ;AACAvF,SAAIwF,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAc7E,MAAd,EAAsB,CAAtB,EAAyBuC,KAAKC,EAAL,GAAU,CAAnC,EAAsC,KAAtC;AACAnD,SAAIyF,IAAJ;AACA9E,eAAU6B,CAAV;AACA;;AAEDxC,QAAI0F,OAAJ;AACA;;AAED,YAASnB,OAAT,GAAmB;;AAElB,QAAIoB,aAAazC,KAAKC,EAAL,GAAUxD,QAAQU,MAAR,CAAeC,GAAf,CAAmBqF,UAA9C;AACA,QAAIhF,SAAShB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnB,GAA4B,CAA5B,GAAgChB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnD,GAA4Df,YAAYD,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAxG;;AAEA;;AAEAX,QAAIkF,IAAJ;AACAlF,QAAImF,SAAJ,CAActF,UAAd,EAAyBC,SAAzB;AACAE,QAAIsF,KAAJ,CAAU,CAAV,EAAa3F,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAhC;AACA;;AAEA;;AAEAZ,QAAIkF,IAAJ;AACA,QAAIU,eAAeD,UAAnB;AACA,SAAK,IAAInD,IAAI,CAAb,EAAgBA,IAAI2B,OAAO1B,MAA3B,EAAmC,EAAED,CAArC,EAAwC;AACvC2B,YAAO3B,CAAP,EAAUmD,UAAV,GAAuBC,YAAvB;AACAC,eAAU1B,OAAO3B,CAAP,EAAUS,KAApB,EAA2BkB,OAAO3B,CAAP,EAAUF,KAArC,EAA4C,IAA5C;AACA;AACDtC,QAAI0F,OAAJ;;AAEA;;AAEA,QAAI/F,QAAQU,MAAR,CAAeC,GAAf,CAAmBwF,MAAnB,CAA0BvC,KAA1B,GAAkC,CAAtC,EAAyC;AACxCvD,SAAIkF,IAAJ;AACAlF,SAAI+F,SAAJ,GAAgBpG,QAAQU,MAAR,CAAeC,GAAf,CAAmBwF,MAAnB,CAA0BvC,KAA1C;AACAqC,oBAAeD,UAAf;AACA,UAAK,IAAInD,IAAI,CAAb,EAAgBA,IAAI2B,OAAO1B,MAA3B,EAAmC,EAAED,CAArC,EAAwC;AACvCqD,gBAAU1B,OAAO3B,CAAP,EAAUS,KAApB,EAA2BtD,QAAQU,MAAR,CAAeC,GAAf,CAAmBwF,MAAnB,CAA0BxD,KAArD,EAA4D,KAA5D;AACA;AACDtC,SAAI0F,OAAJ;AACA;;AAED;;AAEAM,kBAAchG,GAAd;;AAEAA,QAAI0F,OAAJ;;AAEA;;AAEA,QAAI/F,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBF,IAA7B,EAAmC;AAClC,YAAO0F,YAAP;AACA,KAFD,MAEO,OAAO,IAAP;;AAEP,aAASJ,SAAT,CAAmB5C,KAAnB,EAA0BX,KAA1B,EAAiCmD,IAAjC,EAAuC;;AAEtC,SAAIxC,SAAS,CAAT,IAAcL,MAAMK,KAAN,CAAlB,EAAgC;AAC/B;AACA;;AAED,SAAIwC,IAAJ,EAAU;AACTzF,UAAIqF,SAAJ,GAAgB/C,KAAhB;AACA,MAFD,MAEO;AACNtC,UAAIkG,WAAJ,GAAkB5D,KAAlB;AACAtC,UAAImG,QAAJ,GAAe,OAAf;AACA;;AAEDnG,SAAIuF,SAAJ;AACA,SAAIrC,KAAKkD,GAAL,CAASnD,QAAQC,KAAKC,EAAL,GAAU,CAA3B,IAAgC,WAApC,EAAiD;AAChDnD,UAAIqG,MAAJ,CAAW,CAAX,EAAc,CAAd,EADgD,CAC9B;AAClB;;AAED;AACArG,SAAIwF,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAc7E,MAAd,EAAqBiF,YAArB,EAAmCA,eAAe3C,QAAQ,CAA1D,EAA6D,KAA7D;AACAjD,SAAIwF,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAc7E,MAAd,EAAqBiF,eAAe3C,QAAQ,CAA5C,EAA+C2C,eAAe3C,KAA9D,EAAqE,KAArE;AACAjD,SAAIsG,SAAJ;AACA;AACAV,qBAAgB3C,KAAhB;;AAEA,SAAIwC,IAAJ,EAAU;AACTzF,UAAIyF,IAAJ;AACA,MAFD,MAEO;AACNzF,UAAI8F,MAAJ;AACA;AACD;;AAED,aAASG,UAAT,GAAsB;;AAErB,SAAIL,eAAeD,UAAnB;AACA,SAAIhF,SAAShB,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBE,MAAzB,GAAkC,CAAlC,GAAsChB,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBE,MAA/D,GAAwEf,YAAYD,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBE,MAA1H;;AAEA,UAAK,IAAI6B,IAAI,CAAb,EAAgBA,IAAI2B,OAAO1B,MAA3B,EAAmC,EAAED,CAArC,EAAwC;AACvC,UAAI2B,OAAO3B,CAAP,EAAUY,OAAV,IAAqBzD,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBsC,SAAzB,GAAqC,GAA9D,EAAmE;AAClE,WAAI,CAACwD,UAAUpC,OAAO3B,CAAP,CAAV,EAAqBoD,YAArB,EAAmCpD,CAAnC,CAAL,EAA4C;AAC3C,eAAO,KAAP;AACA;AACD;AACDoD,sBAAgBzB,OAAO3B,CAAP,EAAUS,KAA1B;AACA;;AAED,YAAO,IAAP;;AAEA,cAASsD,SAAT,CAAmBC,KAAnB,EAA0Bb,UAA1B,EAAsCc,KAAtC,EAA6C;;AAE5C,UAAID,MAAMhF,IAAN,CAAW,CAAX,EAAc,CAAd,KAAoB,CAAxB,EAA2B;AAC1B,cAAO,IAAP;AACA;;AAED;;AAEA,UAAIkF,KAAK/G,QAAQe,MAAR,CAAeiG,cAAxB;AAAA,UAAwCC,IAAxC;AAAA,UAA8CC,MAAMlH,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBqG,SAA7E;;AAEA,UAAIJ,EAAJ,EAAQ;AACPE,cAAOF,GAAGF,MAAM/F,KAAT,EAAgB+F,KAAhB,CAAP;AACA,OAFD,MAEO;AACNI,cAAOJ,MAAM/F,KAAb;AACA;;AAED,UAAIoG,GAAJ,EAAS;AACRD,cAAOC,IAAID,IAAJ,EAAUJ,KAAV,CAAP;AACA;;AAED,UAAIO,YAAY,CAAEpB,aAAaa,MAAMvD,KAApB,GAA6B0C,UAA9B,IAA4C,CAA5D;AACA,UAAIqB,IAAInH,aAAaqD,KAAK+D,KAAL,CAAW/D,KAAKgE,GAAL,CAASH,SAAT,IAAsBpG,MAAjC,CAArB;AACA,UAAIwG,IAAIrH,YAAYoD,KAAK+D,KAAL,CAAW/D,KAAKkE,GAAL,CAASL,SAAT,IAAsBpG,MAAjC,IAA2ChB,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAlF;;AAEA,UAAIyG,OAAO,wCAAwCZ,KAAxC,GAAgD,iCAAhD,GAAoFU,CAApF,GAAwF,UAAxF,GAAqGH,CAArG,GAAyG,OAAzG,GAAmHJ,IAAnH,GAA0H,SAArI;AACAlH,aAAO4H,MAAP,CAAcD,IAAd;;AAEA,UAAI5G,QAAQf,OAAOiE,QAAP,CAAgB,cAAc8C,KAA9B,CAAZ;AACA,UAAIc,WAAYJ,IAAI1G,MAAMgD,MAAN,KAAiB,CAArC;AACA,UAAI+D,YAAaR,IAAIvG,MAAM8C,KAAN,KAAgB,CAArC;;AAEA9C,YAAMgH,GAAN,CAAU,KAAV,EAAiBF,QAAjB;AACA9G,YAAMgH,GAAN,CAAU,MAAV,EAAkBD,SAAlB;;AAEA;;AAEA,UAAI,IAAID,QAAJ,GAAe,CAAf,IAAoB,IAAIC,SAAJ,GAAgB,CAApC,IAAyChE,gBAAgB+D,WAAW9G,MAAMgD,MAAN,EAA3B,IAA6C,CAAtF,IAA2FJ,eAAemE,YAAY/G,MAAM8C,KAAN,EAA3B,IAA4C,CAA3I,EAA8I;AAC7I,cAAO,KAAP;AACA;;AAED,UAAI5D,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBiH,UAAzB,CAAoCC,OAApC,IAA+C,CAAnD,EAAsD;;AAErD;;AAEA,WAAIC,IAAIjI,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBiH,UAAzB,CAAoCpF,KAA5C;;AAEA,WAAIsF,KAAK,IAAT,EAAe;AACdA,YAAIpB,MAAMlE,KAAV;AACA;;AAED,WAAIuF,MAAM,SAASN,QAAT,GAAoB,UAApB,GAAiCC,SAAjC,GAA6C,KAAvD;AACApI,SAAE,oEAAoEqB,MAAM8C,KAAN,EAApE,GAAoF,YAApF,GAAmG9C,MAAMgD,MAAN,EAAnG,GAAoH,KAApH,GAA4HoE,GAA5H,GAAkI,mBAAlI,GAAwJD,CAAxJ,GAA4J,WAA9J,EACEH,GADF,CACM,SADN,EACiB9H,QAAQU,MAAR,CAAeC,GAAf,CAAmBG,KAAnB,CAAyBiH,UAAzB,CAAoCC,OADrD,EAEEG,YAFF,CAEerH,KAFf;AAGA;;AAED,aAAO,IAAP;AACA,MAzEoB,CAyEnB;AACF,KAxJiB,CAwJhB;AACF,IArR0B,CAqRzB;AACF,GA/ckB,CA+cjB;;AAEF;;AAEA,WAASuF,aAAT,CAAuB+B,KAAvB,EAA8B;AAC7B,OAAIpI,QAAQU,MAAR,CAAeC,GAAf,CAAmB0H,WAAnB,GAAiC,CAArC,EAAwC;;AAEvC;;AAEAD,UAAM7C,IAAN;AACA,QAAI8C,cAAcrI,QAAQU,MAAR,CAAeC,GAAf,CAAmB0H,WAAnB,GAAiC,CAAjC,GAAqCrI,QAAQU,MAAR,CAAeC,GAAf,CAAmB0H,WAAxD,GAAsEpI,YAAYD,QAAQU,MAAR,CAAeC,GAAf,CAAmB0H,WAAvH;AACAD,UAAME,wBAAN,GAAiC,iBAAjC,CANuC,CAMa;AACpDF,UAAMxC,SAAN;AACAwC,UAAM1C,SAAN,GAAkB1F,QAAQU,MAAR,CAAeC,GAAf,CAAmBwF,MAAnB,CAA0BxD,KAA5C;AACAyF,UAAMvC,GAAN,CAAU,CAAV,EAAa,CAAb,EAAgBwC,WAAhB,EAA6B,CAA7B,EAAgC9E,KAAKC,EAAL,GAAU,CAA1C,EAA6C,KAA7C;AACA4E,UAAMtC,IAAN;AACAsC,UAAMzB,SAAN;AACAyB,UAAMrC,OAAN;;AAEA;;AAEAqC,UAAM7C,IAAN;AACA6C,UAAMxC,SAAN;AACAwC,UAAM7B,WAAN,GAAoBvG,QAAQU,MAAR,CAAeC,GAAf,CAAmBwF,MAAnB,CAA0BxD,KAA9C;AACAyF,UAAMvC,GAAN,CAAU,CAAV,EAAa,CAAb,EAAgBwC,WAAhB,EAA6B,CAA7B,EAAgC9E,KAAKC,EAAL,GAAU,CAA1C,EAA6C,KAA7C;AACA4E,UAAMjC,MAAN;AACAiC,UAAMzB,SAAN;AACAyB,UAAMrC,OAAN;;AAEA;AACA;AACD;;AAED;;AAEA,WAASwC,aAAT,CAAuBC,IAAvB,EAA6BC,EAA7B,EAAiC;AAChC,QAAI,IAAIR,IAAI,KAAR,EAAepF,IAAI,CAAC,CAApB,EAAuB6F,IAAIF,KAAK1F,MAAhC,EAAwC6F,IAAID,IAAI,CAApD,EAAuD,EAAE7F,CAAF,GAAM6F,CAA7D,EAAgEC,IAAI9F,CAApE;AACC,KAAE2F,KAAK3F,CAAL,EAAQ,CAAR,KAAc4F,GAAG,CAAH,CAAd,IAAuBA,GAAG,CAAH,IAAQD,KAAKG,CAAL,EAAQ,CAAR,CAAhC,IAAgDH,KAAKG,CAAL,EAAQ,CAAR,KAAcF,GAAG,CAAH,CAAd,IAAuBA,GAAG,CAAH,IAAOD,KAAK3F,CAAL,EAAQ,CAAR,CAA/E,KACI4F,GAAG,CAAH,IAAQ,CAACD,KAAKG,CAAL,EAAQ,CAAR,IAAaH,KAAK3F,CAAL,EAAQ,CAAR,CAAd,KAA6B4F,GAAG,CAAH,IAAQD,KAAK3F,CAAL,EAAQ,CAAR,CAArC,KAAoD2F,KAAKG,CAAL,EAAQ,CAAR,IAAaH,KAAK3F,CAAL,EAAQ,CAAR,CAAjE,IAA+E2F,KAAK3F,CAAL,EAAQ,CAAR,CAD3F,KAEIoF,IAAI,CAACA,CAFT;AADD,IAIA,OAAOA,CAAP;AACA;;AAED,WAASW,eAAT,CAAyBC,MAAzB,EAAiCC,MAAjC,EAAyC;;AAExC,OAAItE,SAAS3E,KAAK0C,OAAL,EAAb;AAAA,OACCvC,UAAUH,KAAKuB,UAAL,EADX;AAAA,OAECJ,SAAShB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnB,GAA4B,CAA5B,GAAgChB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnD,GAA4Df,YAAYD,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAFrG;AAAA,OAGCqG,CAHD;AAAA,OAGIG,CAHJ;;AAKA,QAAK,IAAI3E,IAAI,CAAb,EAAgBA,IAAI2B,OAAO1B,MAA3B,EAAmC,EAAED,CAArC,EAAwC;;AAEvC,QAAIkG,IAAIvE,OAAO3B,CAAP,CAAR;;AAEA,QAAIkG,EAAEpI,GAAF,CAAMC,IAAV,EAAgB;;AAEfP,SAAIkF,IAAJ;AACAlF,SAAIuF,SAAJ;AACAvF,SAAIqG,MAAJ,CAAW,CAAX,EAAc,CAAd,EAJe,CAIG;AAClB;AACArG,SAAIwF,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAc7E,MAAd,EAAsB+H,EAAE/C,UAAxB,EAAoC+C,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,CAA7D,EAAgE,KAAhE;AACAjD,SAAIwF,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAc7E,MAAd,EAAsB+H,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,CAA/C,EAAkDyF,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAnE,EAA0E,KAA1E;AACAjD,SAAIsG,SAAJ;AACAU,SAAIwB,SAAS3I,UAAb;AACAsH,SAAIsB,SAAS3I,SAAb;;AAEA,SAAIE,IAAI2I,aAAR,EAAuB;AACtB,UAAI3I,IAAI2I,aAAJ,CAAkBH,SAAS3I,UAA3B,EAAuC4I,SAAS3I,SAAhD,CAAJ,EAAgE;AAC/DE,WAAI0F,OAAJ;AACA,cAAO;AACNkD,mBAAW,CAACF,EAAEtF,OAAH,EAAYsF,EAAElH,IAAd,CADL;AAENqH,mBAAW,CAFL;AAGNxI,gBAAQqI,CAHF;AAINI,qBAAatG;AAJP,QAAP;AAMA;AACD,MAVD,MAUO;;AAEN;;AAEA,UAAIuG,MAAMpI,SAASuC,KAAKgE,GAAL,CAASwB,EAAE/C,UAAX,CAAnB;AAAA,UACCqD,MAAMrI,SAASuC,KAAKkE,GAAL,CAASsB,EAAE/C,UAAX,CADhB;AAAA,UAECsD,MAAMtI,SAASuC,KAAKgE,GAAL,CAASwB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,CAAlC,CAFhB;AAAA,UAGCiG,MAAMvI,SAASuC,KAAKkE,GAAL,CAASsB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,CAAlC,CAHhB;AAAA,UAICkG,MAAMxI,SAASuC,KAAKgE,GAAL,CAASwB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,CAAlC,CAJhB;AAAA,UAKCmG,MAAMzI,SAASuC,KAAKkE,GAAL,CAASsB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,CAAlC,CALhB;AAAA,UAMCoG,MAAM1I,SAASuC,KAAKgE,GAAL,CAASwB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,GAAlC,CANhB;AAAA,UAOCqG,MAAM3I,SAASuC,KAAKkE,GAAL,CAASsB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAAF,GAAU,GAAlC,CAPhB;AAAA,UAQCsG,MAAM5I,SAASuC,KAAKgE,GAAL,CAASwB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAA1B,CARhB;AAAA,UASCuG,MAAM7I,SAASuC,KAAKkE,GAAL,CAASsB,EAAE/C,UAAF,GAAe+C,EAAEzF,KAA1B,CAThB;AAAA,UAUCwG,UAAU,CAAC,CAAC,CAAD,EAAI,CAAJ,CAAD,EAAS,CAACV,GAAD,EAAMC,GAAN,CAAT,EAAqB,CAACC,GAAD,EAAMC,GAAN,CAArB,EAAiC,CAACC,GAAD,EAAMC,GAAN,CAAjC,EAA6C,CAACC,GAAD,EAAMC,GAAN,CAA7C,EAAyD,CAACC,GAAD,EAAMC,GAAN,CAAzD,CAVX;AAAA,UAWCE,WAAW,CAAC1C,CAAD,EAAIG,CAAJ,CAXZ;;AAaA;;AAEA,UAAIe,cAAcuB,OAAd,EAAuBC,QAAvB,CAAJ,EAAsC;AACrC1J,WAAI0F,OAAJ;AACA,cAAO;AACNkD,mBAAW,CAACF,EAAEtF,OAAH,EAAYsF,EAAElH,IAAd,CADL;AAENqH,mBAAW,CAFL;AAGNxI,gBAAQqI,CAHF;AAINI,qBAAatG;AAJP,QAAP;AAMA;AACD;;AAEDxC,SAAI0F,OAAJ;AACA;AACD;;AAED,UAAO,IAAP;AACA;;AAED,WAASvE,WAAT,CAAqBwI,CAArB,EAAwB;AACvBC,0BAAuB,WAAvB,EAAoCD,CAApC;AACA;;AAED,WAASrI,OAAT,CAAiBqI,CAAjB,EAAoB;AACnBC,0BAAuB,WAAvB,EAAoCD,CAApC;AACA;;AAED;;AAEA,WAASC,sBAAT,CAAgCC,SAAhC,EAA2CF,CAA3C,EAA8C;;AAE7C,OAAI7F,SAAStE,KAAKsE,MAAL,EAAb;AACA,OAAIgG,UAAUC,SAASJ,EAAEK,KAAF,GAAUlG,OAAOE,IAA1B,CAAd;AACA,OAAIiG,UAAWF,SAASJ,EAAEO,KAAF,GAAUpG,OAAOC,GAA1B,CAAf;AACA,OAAIoG,OAAO5B,gBAAgBuB,OAAhB,EAAyBG,OAAzB,CAAX;;AAEA,OAAItK,QAAQa,IAAR,CAAa4J,aAAjB,EAAgC;;AAE/B;;AAEA,SAAK,IAAI5H,IAAI,CAAb,EAAgBA,IAAIvC,WAAWwC,MAA/B,EAAuC,EAAED,CAAzC,EAA4C;AAC3C,SAAI6H,IAAIpK,WAAWuC,CAAX,CAAR;AACA,SAAI6H,EAAEC,IAAF,IAAUT,SAAV,IAAuB,EAAEM,QAAQE,EAAEhK,MAAF,IAAY8J,KAAK9J,MAA3B,CAA3B,EAA+D;AAC9DkK,kBAAYF,EAAEhK,MAAd;AACA;AACD;AACD;;AAED;;AAEA,OAAI8J,IAAJ,EAAU;AACTK,cAAUL,KAAK9J,MAAf,EAAuBwJ,SAAvB;AACA;;AAED;;AAEA,OAAIhC,MAAM,EAAEmC,OAAOL,EAAEK,KAAX,EAAkBE,OAAOP,EAAEO,KAA3B,EAAV;AACAxK,UAAO+K,OAAP,CAAeZ,SAAf,EAA0B,CAAChC,GAAD,EAAMsC,IAAN,CAA1B;AACA;;AAED,WAASK,SAAT,CAAmB9B,CAAnB,EAAsB4B,IAAtB,EAA4B;AAC3B;AACA;AACA;;AAEA,OAAI9H,IAAIkI,iBAAiBhC,CAAjB,CAAR;;AAEA,OAAIlG,KAAK,CAAC,CAAV,EAAa;AACZvC,eAAWG,IAAX,CAAgB,EAAEC,QAAQqI,CAAV,EAAa4B,MAAMA,IAAnB,EAAhB;AACA9K,SAAKmL,oBAAL;AACA,IAHD,MAGO,IAAI,CAACL,IAAL,EAAW;AACjBrK,eAAWuC,CAAX,EAAc8H,IAAd,GAAqB,KAArB;AACA;AACD;;AAED,WAASC,WAAT,CAAqB7B,CAArB,EAAwB;AACvB,OAAIA,KAAK,IAAT,EAAe;AACdzI,iBAAa,EAAb;AACAT,SAAKmL,oBAAL;AACA;;AAED;AACA;AACA;;AAEA,OAAInI,IAAIkI,iBAAiBhC,CAAjB,CAAR;;AAEA,OAAIlG,KAAK,CAAC,CAAV,EAAa;AACZvC,eAAW2K,MAAX,CAAkBpI,CAAlB,EAAqB,CAArB;AACAhD,SAAKmL,oBAAL;AACA;AACD;;AAED,WAASD,gBAAT,CAA0BhC,CAA1B,EAA6B;AAC5B,QAAK,IAAIlG,IAAI,CAAb,EAAgBA,IAAIvC,WAAWwC,MAA/B,EAAuC,EAAED,CAAzC,EAA4C;AAC3C,QAAI6H,IAAIpK,WAAWuC,CAAX,CAAR;AACA,QAAI6H,EAAEhK,MAAF,IAAYqI,CAAhB,EACC,OAAOlG,CAAP;AACD;AACD,UAAO,CAAC,CAAR;AACA;;AAED,WAASd,WAAT,CAAqBlC,IAArB,EAA2BmC,IAA3B,EAAiC;;AAEhC,OAAIhC,UAAUH,KAAKuB,UAAL,EAAd;;AAEA,OAAIJ,SAAShB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnB,GAA4B,CAA5B,GAAgChB,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAnD,GAA4Df,YAAYD,QAAQU,MAAR,CAAeC,GAAf,CAAmBK,MAAxG;;AAEAgB,QAAKuD,IAAL;AACAvD,QAAKwD,SAAL,CAAetF,UAAf,EAA2BC,SAA3B;AACA6B,QAAK2D,KAAL,CAAW,CAAX,EAAc3F,QAAQU,MAAR,CAAeC,GAAf,CAAmBM,IAAjC;;AAEA,QAAK,IAAI4B,IAAI,CAAb,EAAgBA,IAAIvC,WAAWwC,MAA/B,EAAuC,EAAED,CAAzC,EAA4C;AAC3CqI,kBAAc5K,WAAWuC,CAAX,EAAcnC,MAA5B;AACA;;AAED2F,iBAAcrE,IAAd;;AAEAA,QAAK+D,OAAL;;AAEA,YAASmF,aAAT,CAAuBxK,MAAvB,EAA+B;;AAE9B,QAAIA,OAAO4C,KAAP,IAAgB,CAAhB,IAAqBL,MAAMvC,OAAO4C,KAAb,CAAzB,EAA8C;AAC7C;AACA;;AAED;AACAtB,SAAK0D,SAAL,GAAiB,yBAAyB1F,QAAQU,MAAR,CAAeC,GAAf,CAAmBkK,SAAnB,CAA6B7C,OAAtD,GAAgE,GAAjF,CAP8B,CAOwD;AACtFhG,SAAK4D,SAAL;AACA,QAAIrC,KAAKkD,GAAL,CAAS/F,OAAO4C,KAAP,GAAeC,KAAKC,EAAL,GAAU,CAAlC,IAAuC,WAA3C,EAAwD;AACvDxB,UAAK0E,MAAL,CAAY,CAAZ,EAAe,CAAf,EADuD,CACpC;AACnB;AACD1E,SAAK6D,GAAL,CAAS,CAAT,EAAY,CAAZ,EAAe7E,MAAf,EAAuBN,OAAOsF,UAA9B,EAA0CtF,OAAOsF,UAAP,GAAoBtF,OAAO4C,KAAP,GAAe,CAA7E,EAAgF,KAAhF;AACAtB,SAAK6D,GAAL,CAAS,CAAT,EAAY,CAAZ,EAAe7E,MAAf,EAAuBN,OAAOsF,UAAP,GAAoBtF,OAAO4C,KAAP,GAAe,CAA1D,EAA6D5C,OAAOsF,UAAP,GAAoBtF,OAAO4C,KAAxF,EAA+F,KAA/F;AACAtB,SAAK2E,SAAL;AACA3E,SAAK8D,IAAL;AACA;AACD;AACD,EAjsBW,CAisBV;;AAEF;;AAEA,KAAI9F,UAAU;AACbU,UAAQ;AACPC,QAAK;AACJC,UAAM,KADF;AAEJI,YAAQ,MAFJ,EAEY;AAChBqH,iBAAa,CAHT,EAGY;AAChBrC,gBAAY,IAAE,CAJV;AAKJ/E,UAAM,CALF;AAMJkE,YAAQ;AACPd,WAAM,CADC,EACE;AACTD,UAAK,EAFE,EAEE;AACTkB,YAAO,IAHA,CAGK;AAHL,KANJ;AAWJnB,YAAQ;AACPC,UAAK,CADE;AAEPC,WAAM;AAFC,KAXJ;AAeJ8B,YAAQ;AACPxD,YAAO,MADA;AAEPiB,YAAO;AAFA,KAfJ;AAmBJ9C,WAAO;AACNF,WAAM,MADA;AAENuG,gBAAW,mBAASrG,KAAT,EAAgB+F,KAAhB,EAAuB;AACjC,aAAO,uEAAuEA,MAAMlE,KAA7E,GAAqF,KAArF,GAA6F7B,KAA7F,GAAqG,OAArG,GAA+GyC,KAAK+D,KAAL,CAAWT,MAAMpD,OAAjB,CAA/G,GAA2I,SAAlJ;AACA,MAJK,EAIH;AACHzC,aAAQ,CALF,EAKK;AACX+G,iBAAY;AACXpF,aAAO,IADI;AAEXqF,eAAS;AAFE,MANN;AAUN5E,gBAAW,CAVL,CAUO;AAVP,KAnBH;AA+BJd,aAAS;AACRc,gBAAW,CAAC,CADJ,EACO;AACfT,YAAO,IAFC,EAEK;AACb7B,YAAO,OAHC,CAGO;AAHP,KA/BL;AAoCJ+J,eAAW;AACV;AACA7C,cAAS;AAFC;AApCP;AADE;AADK,EAAd;;AA8CAvI,GAAEI,IAAF,CAAOsL,OAAP,CAAe1K,IAAf,CAAoB;AACnBb,QAAMA,IADa;AAEnBI,WAASA,OAFU;AAGnBoL,QAAM,KAHa;AAInBC,WAAS;AAJU,EAApB;AAOA,CA1vBD,EA0vBGC,MA1vBH","file":"jquery.flot.pie.js","sourcesContent":["/* Flot plugin for rendering pie charts.\r\n\r\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\r\nLicensed under the MIT license.\r\n\r\nThe plugin assumes that each series has a single data value, and that each\r\nvalue is a positive integer or zero.  Negative numbers don't make sense for a\r\npie chart, and have unpredictable results.  The values do NOT need to be\r\npassed in as percentages; the plugin will calculate the total and per-slice\r\npercentages internally.\r\n\r\n* Created by Brian Medendorp\r\n\r\n* Updated with contributions from btburnett3, Anthony Aragues and Xavi Ivars\r\n\r\nThe plugin supports these options:\r\n\r\n\tseries: {\r\n\t\tpie: {\r\n\t\t\tshow: true/false\r\n\t\t\tradius: 0-1 for percentage of fullsize, or a specified pixel length, or 'auto'\r\n\t\t\tinnerRadius: 0-1 for percentage of fullsize or a specified pixel length, for creating a donut effect\r\n\t\t\tstartAngle: 0-2 factor of PI used for starting angle (in radians) i.e 3/2 starts at the top, 0 and 2 have the same result\r\n\t\t\ttilt: 0-1 for percentage to tilt the pie, where 1 is no tilt, and 0 is completely flat (nothing will show)\r\n\t\t\toffset: {\r\n\t\t\t\ttop: integer value to move the pie up or down\r\n\t\t\t\tleft: integer value to move the pie left or right, or 'auto'\r\n\t\t\t},\r\n\t\t\tstroke: {\r\n\t\t\t\tcolor: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#FFF')\r\n\t\t\t\twidth: integer pixel width of the stroke\r\n\t\t\t},\r\n\t\t\tlabel: {\r\n\t\t\t\tshow: true/false, or 'auto'\r\n\t\t\t\tformatter:  a user-defined function that modifies the text/style of the label text\r\n\t\t\t\tradius: 0-1 for percentage of fullsize, or a specified pixel length\r\n\t\t\t\tbackground: {\r\n\t\t\t\t\tcolor: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#000')\r\n\t\t\t\t\topacity: 0-1\r\n\t\t\t\t},\r\n\t\t\t\tthreshold: 0-1 for the percentage value at which to hide labels (if they're too small)\r\n\t\t\t},\r\n\t\t\tcombine: {\r\n\t\t\t\tthreshold: 0-1 for the percentage value at which to combine slices (if they're too small)\r\n\t\t\t\tcolor: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#CCC'), if null, the plugin will automatically use the color of the first slice to be combined\r\n\t\t\t\tlabel: any text value of what the combined slice should be labeled\r\n\t\t\t}\r\n\t\t\thighlight: {\r\n\t\t\t\topacity: 0-1\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\nMore detail and specific examples can be found in the included HTML file.\r\n\r\n*/\r\n\r\n(function($) {\r\n\r\n\t// Maximum redraw attempts when fitting labels within the plot\r\n\r\n\tvar REDRAW_ATTEMPTS = 10;\r\n\r\n\t// Factor by which to shrink the pie when fitting labels within the plot\r\n\r\n\tvar REDRAW_SHRINK = 0.95;\r\n\r\n\tfunction init(plot) {\r\n\r\n\t\tvar canvas = null,\r\n\t\t\ttarget = null,\r\n\t\t\toptions = null,\r\n\t\t\tmaxRadius = null,\r\n\t\t\tcenterLeft = null,\r\n\t\t\tcenterTop = null,\r\n\t\t\tprocessed = false,\r\n\t\t\tctx = null;\r\n\r\n\t\t// interactive variables\r\n\r\n\t\tvar highlights = [];\r\n\r\n\t\t// add hook to determine if pie plugin in enabled, and then perform necessary operations\r\n\r\n\t\tplot.hooks.processOptions.push(function(plot, options) {\r\n\t\t\tif (options.series.pie.show) {\r\n\r\n\t\t\t\toptions.grid.show = false;\r\n\r\n\t\t\t\t// set labels.show\r\n\r\n\t\t\t\tif (options.series.pie.label.show == \"auto\") {\r\n\t\t\t\t\tif (options.legend.show) {\r\n\t\t\t\t\t\toptions.series.pie.label.show = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toptions.series.pie.label.show = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// set radius\r\n\r\n\t\t\t\tif (options.series.pie.radius == \"auto\") {\r\n\t\t\t\t\tif (options.series.pie.label.show) {\r\n\t\t\t\t\t\toptions.series.pie.radius = 3/4;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toptions.series.pie.radius = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// ensure sane tilt\r\n\r\n\t\t\t\tif (options.series.pie.tilt > 1) {\r\n\t\t\t\t\toptions.series.pie.tilt = 1;\r\n\t\t\t\t} else if (options.series.pie.tilt < 0) {\r\n\t\t\t\t\toptions.series.pie.tilt = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tplot.hooks.bindEvents.push(function(plot, eventHolder) {\r\n\t\t\tvar options = plot.getOptions();\r\n\t\t\tif (options.series.pie.show) {\r\n\t\t\t\tif (options.grid.hoverable) {\r\n\t\t\t\t\teventHolder.unbind(\"mousemove\").mousemove(onMouseMove);\r\n\t\t\t\t}\r\n\t\t\t\tif (options.grid.clickable) {\r\n\t\t\t\t\teventHolder.unbind(\"click\").click(onClick);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tplot.hooks.processDatapoints.push(function(plot, series, data, datapoints) {\r\n\t\t\tvar options = plot.getOptions();\r\n\t\t\tif (options.series.pie.show) {\r\n\t\t\t\tprocessDatapoints(plot, series, data, datapoints);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tplot.hooks.drawOverlay.push(function(plot, octx) {\r\n\t\t\tvar options = plot.getOptions();\r\n\t\t\tif (options.series.pie.show) {\r\n\t\t\t\tdrawOverlay(plot, octx);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tplot.hooks.draw.push(function(plot, newCtx) {\r\n\t\t\tvar options = plot.getOptions();\r\n\t\t\tif (options.series.pie.show) {\r\n\t\t\t\tdraw(plot, newCtx);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfunction processDatapoints(plot, series, datapoints) {\r\n\t\t\tif (!processed)\t{\r\n\t\t\t\tprocessed = true;\r\n\t\t\t\tcanvas = plot.getCanvas();\r\n\t\t\t\ttarget = $(canvas).parent();\r\n\t\t\t\toptions = plot.getOptions();\r\n\t\t\t\tplot.setData(combine(plot.getData()));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction combine(data) {\r\n\r\n\t\t\tvar total = 0,\r\n\t\t\t\tcombined = 0,\r\n\t\t\t\tnumCombined = 0,\r\n\t\t\t\tcolor = options.series.pie.combine.color,\r\n\t\t\t\tnewdata = [];\r\n\r\n\t\t\t// Fix up the raw data from Flot, ensuring the data is numeric\r\n\r\n\t\t\tfor (var i = 0; i < data.length; ++i) {\r\n\r\n\t\t\t\tvar value = data[i].data;\r\n\r\n\t\t\t\t// If the data is an array, we'll assume that it's a standard\r\n\t\t\t\t// Flot x-y pair, and are concerned only with the second value.\r\n\r\n\t\t\t\t// Note how we use the original array, rather than creating a\r\n\t\t\t\t// new one; this is more efficient and preserves any extra data\r\n\t\t\t\t// that the user may have stored in higher indexes.\r\n\r\n\t\t\t\tif ($.isArray(value) && value.length == 1) {\r\n    \t\t\t\tvalue = value[0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($.isArray(value)) {\r\n\t\t\t\t\t// Equivalent to $.isNumeric() but compatible with jQuery < 1.7\r\n\t\t\t\t\tif (!isNaN(parseFloat(value[1])) && isFinite(value[1])) {\r\n\t\t\t\t\t\tvalue[1] = +value[1];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalue[1] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!isNaN(parseFloat(value)) && isFinite(value)) {\r\n\t\t\t\t\tvalue = [1, +value];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue = [1, 0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata[i].data = [value];\r\n\t\t\t}\r\n\r\n\t\t\t// Sum up all the slices, so we can calculate percentages for each\r\n\r\n\t\t\tfor (var i = 0; i < data.length; ++i) {\r\n\t\t\t\ttotal += data[i].data[0][1];\r\n\t\t\t}\r\n\r\n\t\t\t// Count the number of slices with percentages below the combine\r\n\t\t\t// threshold; if it turns out to be just one, we won't combine.\r\n\r\n\t\t\tfor (var i = 0; i < data.length; ++i) {\r\n\t\t\t\tvar value = data[i].data[0][1];\r\n\t\t\t\tif (value / total <= options.series.pie.combine.threshold) {\r\n\t\t\t\t\tcombined += value;\r\n\t\t\t\t\tnumCombined++;\r\n\t\t\t\t\tif (!color) {\r\n\t\t\t\t\t\tcolor = data[i].color;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < data.length; ++i) {\r\n\t\t\t\tvar value = data[i].data[0][1];\r\n\t\t\t\tif (numCombined < 2 || value / total > options.series.pie.combine.threshold) {\r\n\t\t\t\t\tnewdata.push(\r\n\t\t\t\t\t\t$.extend(data[i], {     /* extend to allow keeping all other original data values\r\n\t\t\t\t\t\t                           and using them e.g. in labelFormatter. */\r\n\t\t\t\t\t\t\tdata: [[1, value]],\r\n\t\t\t\t\t\t\tcolor: data[i].color,\r\n\t\t\t\t\t\t\tlabel: data[i].label,\r\n\t\t\t\t\t\t\tangle: value * Math.PI * 2 / total,\r\n\t\t\t\t\t\t\tpercent: value / (total / 100)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (numCombined > 1) {\r\n\t\t\t\tnewdata.push({\r\n\t\t\t\t\tdata: [[1, combined]],\r\n\t\t\t\t\tcolor: color,\r\n\t\t\t\t\tlabel: options.series.pie.combine.label,\r\n\t\t\t\t\tangle: combined * Math.PI * 2 / total,\r\n\t\t\t\t\tpercent: combined / (total / 100)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn newdata;\r\n\t\t}\r\n\r\n\t\tfunction draw(plot, newCtx) {\r\n\r\n\t\t\tif (!target) {\r\n\t\t\t\treturn; // if no series were passed\r\n\t\t\t}\r\n\r\n\t\t\tvar canvasWidth = plot.getPlaceholder().width(),\r\n\t\t\t\tcanvasHeight = plot.getPlaceholder().height(),\r\n\t\t\t\tlegendWidth = target.children().filter(\".legend\").children().width() || 0;\r\n\r\n\t\t\tctx = newCtx;\r\n\r\n\t\t\t// WARNING: HACK! REWRITE THIS CODE AS SOON AS POSSIBLE!\r\n\r\n\t\t\t// When combining smaller slices into an 'other' slice, we need to\r\n\t\t\t// add a new series.  Since Flot gives plugins no way to modify the\r\n\t\t\t// list of series, the pie plugin uses a hack where the first call\r\n\t\t\t// to processDatapoints results in a call to setData with the new\r\n\t\t\t// list of series, then subsequent processDatapoints do nothing.\r\n\r\n\t\t\t// The plugin-global 'processed' flag is used to control this hack;\r\n\t\t\t// it starts out false, and is set to true after the first call to\r\n\t\t\t// processDatapoints.\r\n\r\n\t\t\t// Unfortunately this turns future setData calls into no-ops; they\r\n\t\t\t// call processDatapoints, the flag is true, and nothing happens.\r\n\r\n\t\t\t// To fix this we'll set the flag back to false here in draw, when\r\n\t\t\t// all series have been processed, so the next sequence of calls to\r\n\t\t\t// processDatapoints once again starts out with a slice-combine.\r\n\t\t\t// This is really a hack; in 0.9 we need to give plugins a proper\r\n\t\t\t// way to modify series before any processing begins.\r\n\r\n\t\t\tprocessed = false;\r\n\r\n\t\t\t// calculate maximum radius and center point\r\n\r\n\t\t\tmaxRadius =  Math.min(canvasWidth, canvasHeight / options.series.pie.tilt) / 2;\r\n\t\t\tcenterTop = canvasHeight / 2 + options.series.pie.offset.top;\r\n\t\t\tcenterLeft = canvasWidth / 2;\r\n\r\n\t\t\tif (options.series.pie.offset.left == \"auto\") {\r\n\t\t\t\tif (options.legend.position.match(\"w\")) {\r\n\t\t\t\t\tcenterLeft += legendWidth / 2;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcenterLeft -= legendWidth / 2;\r\n\t\t\t\t}\r\n\t\t\t\tif (centerLeft < maxRadius) {\r\n\t\t\t\t\tcenterLeft = maxRadius;\r\n\t\t\t\t} else if (centerLeft > canvasWidth - maxRadius) {\r\n\t\t\t\t\tcenterLeft = canvasWidth - maxRadius;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tcenterLeft += options.series.pie.offset.left;\r\n\t\t\t}\r\n\r\n\t\t\tvar slices = plot.getData(),\r\n\t\t\t\tattempts = 0;\r\n\r\n\t\t\t// Keep shrinking the pie's radius until drawPie returns true,\r\n\t\t\t// indicating that all the labels fit, or we try too many times.\r\n\r\n\t\t\tdo {\r\n\t\t\t\tif (attempts > 0) {\r\n\t\t\t\t\tmaxRadius *= REDRAW_SHRINK;\r\n\t\t\t\t}\r\n\t\t\t\tattempts += 1;\r\n\t\t\t\tclear();\r\n\t\t\t\tif (options.series.pie.tilt <= 0.8) {\r\n\t\t\t\t\tdrawShadow();\r\n\t\t\t\t}\r\n\t\t\t} while (!drawPie() && attempts < REDRAW_ATTEMPTS)\r\n\r\n\t\t\tif (attempts >= REDRAW_ATTEMPTS) {\r\n\t\t\t\tclear();\r\n\t\t\t\ttarget.prepend(\"<div class='error'>Could not draw pie with labels contained inside canvas</div>\");\r\n\t\t\t}\r\n\r\n\t\t\tif (plot.setSeries && plot.insertLegend) {\r\n\t\t\t\tplot.setSeries(slices);\r\n\t\t\t\tplot.insertLegend();\r\n\t\t\t}\r\n\r\n\t\t\t// we're actually done at this point, just defining internal functions at this point\r\n\r\n\t\t\tfunction clear() {\r\n\t\t\t\tctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n\t\t\t\ttarget.children().filter(\".pieLabel, .pieLabelBackground\").remove();\r\n\t\t\t}\r\n\r\n\t\t\tfunction drawShadow() {\r\n\r\n\t\t\t\tvar shadowLeft = options.series.pie.shadow.left;\r\n\t\t\t\tvar shadowTop = options.series.pie.shadow.top;\r\n\t\t\t\tvar edge = 10;\r\n\t\t\t\tvar alpha = options.series.pie.shadow.alpha;\r\n\t\t\t\tvar radius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius;\r\n\r\n\t\t\t\tif (radius >= canvasWidth / 2 - shadowLeft || radius * options.series.pie.tilt >= canvasHeight / 2 - shadowTop || radius <= edge) {\r\n\t\t\t\t\treturn;\t// shadow would be outside canvas, so don't draw it\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.translate(shadowLeft,shadowTop);\r\n\t\t\t\tctx.globalAlpha = alpha;\r\n\t\t\t\tctx.fillStyle = \"#000\";\r\n\r\n\t\t\t\t// center and rotate to starting position\r\n\r\n\t\t\t\tctx.translate(centerLeft,centerTop);\r\n\t\t\t\tctx.scale(1, options.series.pie.tilt);\r\n\r\n\t\t\t\t//radius -= edge;\r\n\r\n\t\t\t\tfor (var i = 1; i <= edge; i++) {\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.arc(0, 0, radius, 0, Math.PI * 2, false);\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t\tradius -= i;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\r\n\t\t\tfunction drawPie() {\r\n\r\n\t\t\t\tvar startAngle = Math.PI * options.series.pie.startAngle;\r\n\t\t\t\tvar radius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius;\r\n\r\n\t\t\t\t// center and rotate to starting position\r\n\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.translate(centerLeft,centerTop);\r\n\t\t\t\tctx.scale(1, options.series.pie.tilt);\r\n\t\t\t\t//ctx.rotate(startAngle); // start at top; -- This doesn't work properly in Opera\r\n\r\n\t\t\t\t// draw slices\r\n\r\n\t\t\t\tctx.save();\r\n\t\t\t\tvar currentAngle = startAngle;\r\n\t\t\t\tfor (var i = 0; i < slices.length; ++i) {\r\n\t\t\t\t\tslices[i].startAngle = currentAngle;\r\n\t\t\t\t\tdrawSlice(slices[i].angle, slices[i].color, true);\r\n\t\t\t\t}\r\n\t\t\t\tctx.restore();\r\n\r\n\t\t\t\t// draw slice outlines\r\n\r\n\t\t\t\tif (options.series.pie.stroke.width > 0) {\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.lineWidth = options.series.pie.stroke.width;\r\n\t\t\t\t\tcurrentAngle = startAngle;\r\n\t\t\t\t\tfor (var i = 0; i < slices.length; ++i) {\r\n\t\t\t\t\t\tdrawSlice(slices[i].angle, options.series.pie.stroke.color, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// draw donut hole\r\n\r\n\t\t\t\tdrawDonutHole(ctx);\r\n\r\n\t\t\t\tctx.restore();\r\n\r\n\t\t\t\t// Draw the labels, returning true if they fit within the plot\r\n\r\n\t\t\t\tif (options.series.pie.label.show) {\r\n\t\t\t\t\treturn drawLabels();\r\n\t\t\t\t} else return true;\r\n\r\n\t\t\t\tfunction drawSlice(angle, color, fill) {\r\n\r\n\t\t\t\t\tif (angle <= 0 || isNaN(angle)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (fill) {\r\n\t\t\t\t\t\tctx.fillStyle = color;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tctx.strokeStyle = color;\r\n\t\t\t\t\t\tctx.lineJoin = \"round\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tif (Math.abs(angle - Math.PI * 2) > 0.000000001) {\r\n\t\t\t\t\t\tctx.moveTo(0, 0); // Center of the pie\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//ctx.arc(0, 0, radius, 0, angle, false); // This doesn't work properly in Opera\r\n\t\t\t\t\tctx.arc(0, 0, radius,currentAngle, currentAngle + angle / 2, false);\r\n\t\t\t\t\tctx.arc(0, 0, radius,currentAngle + angle / 2, currentAngle + angle, false);\r\n\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t//ctx.rotate(angle); // This doesn't work properly in Opera\r\n\t\t\t\t\tcurrentAngle += angle;\r\n\r\n\t\t\t\t\tif (fill) {\r\n\t\t\t\t\t\tctx.fill();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction drawLabels() {\r\n\r\n\t\t\t\t\tvar currentAngle = startAngle;\r\n\t\t\t\t\tvar radius = options.series.pie.label.radius > 1 ? options.series.pie.label.radius : maxRadius * options.series.pie.label.radius;\r\n\r\n\t\t\t\t\tfor (var i = 0; i < slices.length; ++i) {\r\n\t\t\t\t\t\tif (slices[i].percent >= options.series.pie.label.threshold * 100) {\r\n\t\t\t\t\t\t\tif (!drawLabel(slices[i], currentAngle, i)) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcurrentAngle += slices[i].angle;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\tfunction drawLabel(slice, startAngle, index) {\r\n\r\n\t\t\t\t\t\tif (slice.data[0][1] == 0) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// format label text\r\n\r\n\t\t\t\t\t\tvar lf = options.legend.labelFormatter, text, plf = options.series.pie.label.formatter;\r\n\r\n\t\t\t\t\t\tif (lf) {\r\n\t\t\t\t\t\t\ttext = lf(slice.label, slice);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttext = slice.label;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (plf) {\r\n\t\t\t\t\t\t\ttext = plf(text, slice);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar halfAngle = ((startAngle + slice.angle) + startAngle) / 2;\r\n\t\t\t\t\t\tvar x = centerLeft + Math.round(Math.cos(halfAngle) * radius);\r\n\t\t\t\t\t\tvar y = centerTop + Math.round(Math.sin(halfAngle) * radius) * options.series.pie.tilt;\r\n\r\n\t\t\t\t\t\tvar html = \"<span class='pieLabel' id='pieLabel\" + index + \"' style='position:absolute;top:\" + y + \"px;left:\" + x + \"px;'>\" + text + \"</span>\";\r\n\t\t\t\t\t\ttarget.append(html);\r\n\r\n\t\t\t\t\t\tvar label = target.children(\"#pieLabel\" + index);\r\n\t\t\t\t\t\tvar labelTop = (y - label.height() / 2);\r\n\t\t\t\t\t\tvar labelLeft = (x - label.width() / 2);\r\n\r\n\t\t\t\t\t\tlabel.css(\"top\", labelTop);\r\n\t\t\t\t\t\tlabel.css(\"left\", labelLeft);\r\n\r\n\t\t\t\t\t\t// check to make sure that the label is not outside the canvas\r\n\r\n\t\t\t\t\t\tif (0 - labelTop > 0 || 0 - labelLeft > 0 || canvasHeight - (labelTop + label.height()) < 0 || canvasWidth - (labelLeft + label.width()) < 0) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (options.series.pie.label.background.opacity != 0) {\r\n\r\n\t\t\t\t\t\t\t// put in the transparent background separately to avoid blended labels and label boxes\r\n\r\n\t\t\t\t\t\t\tvar c = options.series.pie.label.background.color;\r\n\r\n\t\t\t\t\t\t\tif (c == null) {\r\n\t\t\t\t\t\t\t\tc = slice.color;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar pos = \"top:\" + labelTop + \"px;left:\" + labelLeft + \"px;\";\r\n\t\t\t\t\t\t\t$(\"<div class='pieLabelBackground' style='position:absolute;width:\" + label.width() + \"px;height:\" + label.height() + \"px;\" + pos + \"background-color:\" + c + \";'></div>\")\r\n\t\t\t\t\t\t\t\t.css(\"opacity\", options.series.pie.label.background.opacity)\r\n\t\t\t\t\t\t\t\t.insertBefore(label);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} // end individual label function\r\n\t\t\t\t} // end drawLabels function\r\n\t\t\t} // end drawPie function\r\n\t\t} // end draw function\r\n\r\n\t\t// Placed here because it needs to be accessed from multiple locations\r\n\r\n\t\tfunction drawDonutHole(layer) {\r\n\t\t\tif (options.series.pie.innerRadius > 0) {\r\n\r\n\t\t\t\t// subtract the center\r\n\r\n\t\t\t\tlayer.save();\r\n\t\t\t\tvar innerRadius = options.series.pie.innerRadius > 1 ? options.series.pie.innerRadius : maxRadius * options.series.pie.innerRadius;\r\n\t\t\t\tlayer.globalCompositeOperation = \"destination-out\"; // this does not work with excanvas, but it will fall back to using the stroke color\r\n\t\t\t\tlayer.beginPath();\r\n\t\t\t\tlayer.fillStyle = options.series.pie.stroke.color;\r\n\t\t\t\tlayer.arc(0, 0, innerRadius, 0, Math.PI * 2, false);\r\n\t\t\t\tlayer.fill();\r\n\t\t\t\tlayer.closePath();\r\n\t\t\t\tlayer.restore();\r\n\r\n\t\t\t\t// add inner stroke\r\n\r\n\t\t\t\tlayer.save();\r\n\t\t\t\tlayer.beginPath();\r\n\t\t\t\tlayer.strokeStyle = options.series.pie.stroke.color;\r\n\t\t\t\tlayer.arc(0, 0, innerRadius, 0, Math.PI * 2, false);\r\n\t\t\t\tlayer.stroke();\r\n\t\t\t\tlayer.closePath();\r\n\t\t\t\tlayer.restore();\r\n\r\n\t\t\t\t// TODO: add extra shadow inside hole (with a mask) if the pie is tilted.\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//-- Additional Interactive related functions --\r\n\r\n\t\tfunction isPointInPoly(poly, pt) {\r\n\t\t\tfor(var c = false, i = -1, l = poly.length, j = l - 1; ++i < l; j = i)\r\n\t\t\t\t((poly[i][1] <= pt[1] && pt[1] < poly[j][1]) || (poly[j][1] <= pt[1] && pt[1]< poly[i][1]))\r\n\t\t\t\t&& (pt[0] < (poly[j][0] - poly[i][0]) * (pt[1] - poly[i][1]) / (poly[j][1] - poly[i][1]) + poly[i][0])\r\n\t\t\t\t&& (c = !c);\r\n\t\t\treturn c;\r\n\t\t}\r\n\r\n\t\tfunction findNearbySlice(mouseX, mouseY) {\r\n\r\n\t\t\tvar slices = plot.getData(),\r\n\t\t\t\toptions = plot.getOptions(),\r\n\t\t\t\tradius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius,\r\n\t\t\t\tx, y;\r\n\r\n\t\t\tfor (var i = 0; i < slices.length; ++i) {\r\n\r\n\t\t\t\tvar s = slices[i];\r\n\r\n\t\t\t\tif (s.pie.show) {\r\n\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.moveTo(0, 0); // Center of the pie\r\n\t\t\t\t\t//ctx.scale(1, options.series.pie.tilt);\t// this actually seems to break everything when here.\r\n\t\t\t\t\tctx.arc(0, 0, radius, s.startAngle, s.startAngle + s.angle / 2, false);\r\n\t\t\t\t\tctx.arc(0, 0, radius, s.startAngle + s.angle / 2, s.startAngle + s.angle, false);\r\n\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\tx = mouseX - centerLeft;\r\n\t\t\t\t\ty = mouseY - centerTop;\r\n\r\n\t\t\t\t\tif (ctx.isPointInPath) {\r\n\t\t\t\t\t\tif (ctx.isPointInPath(mouseX - centerLeft, mouseY - centerTop)) {\r\n\t\t\t\t\t\t\tctx.restore();\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tdatapoint: [s.percent, s.data],\r\n\t\t\t\t\t\t\t\tdataIndex: 0,\r\n\t\t\t\t\t\t\t\tseries: s,\r\n\t\t\t\t\t\t\t\tseriesIndex: i\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// excanvas for IE doesn;t support isPointInPath, this is a workaround.\r\n\r\n\t\t\t\t\t\tvar p1X = radius * Math.cos(s.startAngle),\r\n\t\t\t\t\t\t\tp1Y = radius * Math.sin(s.startAngle),\r\n\t\t\t\t\t\t\tp2X = radius * Math.cos(s.startAngle + s.angle / 4),\r\n\t\t\t\t\t\t\tp2Y = radius * Math.sin(s.startAngle + s.angle / 4),\r\n\t\t\t\t\t\t\tp3X = radius * Math.cos(s.startAngle + s.angle / 2),\r\n\t\t\t\t\t\t\tp3Y = radius * Math.sin(s.startAngle + s.angle / 2),\r\n\t\t\t\t\t\t\tp4X = radius * Math.cos(s.startAngle + s.angle / 1.5),\r\n\t\t\t\t\t\t\tp4Y = radius * Math.sin(s.startAngle + s.angle / 1.5),\r\n\t\t\t\t\t\t\tp5X = radius * Math.cos(s.startAngle + s.angle),\r\n\t\t\t\t\t\t\tp5Y = radius * Math.sin(s.startAngle + s.angle),\r\n\t\t\t\t\t\t\tarrPoly = [[0, 0], [p1X, p1Y], [p2X, p2Y], [p3X, p3Y], [p4X, p4Y], [p5X, p5Y]],\r\n\t\t\t\t\t\t\tarrPoint = [x, y];\r\n\r\n\t\t\t\t\t\t// TODO: perhaps do some mathmatical trickery here with the Y-coordinate to compensate for pie tilt?\r\n\r\n\t\t\t\t\t\tif (isPointInPoly(arrPoly, arrPoint)) {\r\n\t\t\t\t\t\t\tctx.restore();\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tdatapoint: [s.percent, s.data],\r\n\t\t\t\t\t\t\t\tdataIndex: 0,\r\n\t\t\t\t\t\t\t\tseries: s,\r\n\t\t\t\t\t\t\t\tseriesIndex: i\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfunction onMouseMove(e) {\r\n\t\t\ttriggerClickHoverEvent(\"plothover\", e);\r\n\t\t}\r\n\r\n\t\tfunction onClick(e) {\r\n\t\t\ttriggerClickHoverEvent(\"plotclick\", e);\r\n\t\t}\r\n\r\n\t\t// trigger click or hover event (they send the same parameters so we share their code)\r\n\r\n\t\tfunction triggerClickHoverEvent(eventname, e) {\r\n\r\n\t\t\tvar offset = plot.offset();\r\n\t\t\tvar canvasX = parseInt(e.pageX - offset.left);\r\n\t\t\tvar canvasY =  parseInt(e.pageY - offset.top);\r\n\t\t\tvar item = findNearbySlice(canvasX, canvasY);\r\n\r\n\t\t\tif (options.grid.autoHighlight) {\r\n\r\n\t\t\t\t// clear auto-highlights\r\n\r\n\t\t\t\tfor (var i = 0; i < highlights.length; ++i) {\r\n\t\t\t\t\tvar h = highlights[i];\r\n\t\t\t\t\tif (h.auto == eventname && !(item && h.series == item.series)) {\r\n\t\t\t\t\t\tunhighlight(h.series);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// highlight the slice\r\n\r\n\t\t\tif (item) {\r\n\t\t\t\thighlight(item.series, eventname);\r\n\t\t\t}\r\n\r\n\t\t\t// trigger any hover bind events\r\n\r\n\t\t\tvar pos = { pageX: e.pageX, pageY: e.pageY };\r\n\t\t\ttarget.trigger(eventname, [pos, item]);\r\n\t\t}\r\n\r\n\t\tfunction highlight(s, auto) {\r\n\t\t\t//if (typeof s == \"number\") {\r\n\t\t\t//\ts = series[s];\r\n\t\t\t//}\r\n\r\n\t\t\tvar i = indexOfHighlight(s);\r\n\r\n\t\t\tif (i == -1) {\r\n\t\t\t\thighlights.push({ series: s, auto: auto });\r\n\t\t\t\tplot.triggerRedrawOverlay();\r\n\t\t\t} else if (!auto) {\r\n\t\t\t\thighlights[i].auto = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction unhighlight(s) {\r\n\t\t\tif (s == null) {\r\n\t\t\t\thighlights = [];\r\n\t\t\t\tplot.triggerRedrawOverlay();\r\n\t\t\t}\r\n\r\n\t\t\t//if (typeof s == \"number\") {\r\n\t\t\t//\ts = series[s];\r\n\t\t\t//}\r\n\r\n\t\t\tvar i = indexOfHighlight(s);\r\n\r\n\t\t\tif (i != -1) {\r\n\t\t\t\thighlights.splice(i, 1);\r\n\t\t\t\tplot.triggerRedrawOverlay();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction indexOfHighlight(s) {\r\n\t\t\tfor (var i = 0; i < highlights.length; ++i) {\r\n\t\t\t\tvar h = highlights[i];\r\n\t\t\t\tif (h.series == s)\r\n\t\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tfunction drawOverlay(plot, octx) {\r\n\r\n\t\t\tvar options = plot.getOptions();\r\n\r\n\t\t\tvar radius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius;\r\n\r\n\t\t\toctx.save();\r\n\t\t\toctx.translate(centerLeft, centerTop);\r\n\t\t\toctx.scale(1, options.series.pie.tilt);\r\n\r\n\t\t\tfor (var i = 0; i < highlights.length; ++i) {\r\n\t\t\t\tdrawHighlight(highlights[i].series);\r\n\t\t\t}\r\n\r\n\t\t\tdrawDonutHole(octx);\r\n\r\n\t\t\toctx.restore();\r\n\r\n\t\t\tfunction drawHighlight(series) {\r\n\r\n\t\t\t\tif (series.angle <= 0 || isNaN(series.angle)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//octx.fillStyle = parseColor(options.series.pie.highlight.color).scale(null, null, null, options.series.pie.highlight.opacity).toString();\r\n\t\t\t\toctx.fillStyle = \"rgba(255, 255, 255, \" + options.series.pie.highlight.opacity + \")\"; // this is temporary until we have access to parseColor\r\n\t\t\t\toctx.beginPath();\r\n\t\t\t\tif (Math.abs(series.angle - Math.PI * 2) > 0.000000001) {\r\n\t\t\t\t\toctx.moveTo(0, 0); // Center of the pie\r\n\t\t\t\t}\r\n\t\t\t\toctx.arc(0, 0, radius, series.startAngle, series.startAngle + series.angle / 2, false);\r\n\t\t\t\toctx.arc(0, 0, radius, series.startAngle + series.angle / 2, series.startAngle + series.angle, false);\r\n\t\t\t\toctx.closePath();\r\n\t\t\t\toctx.fill();\r\n\t\t\t}\r\n\t\t}\r\n\t} // end init (plugin body)\r\n\r\n\t// define pie specific options and their default values\r\n\r\n\tvar options = {\r\n\t\tseries: {\r\n\t\t\tpie: {\r\n\t\t\t\tshow: false,\r\n\t\t\t\tradius: \"auto\",\t// actual radius of the visible pie (based on full calculated radius if <=1, or hard pixel value)\r\n\t\t\t\tinnerRadius: 0, /* for donut */\r\n\t\t\t\tstartAngle: 3/2,\r\n\t\t\t\ttilt: 1,\r\n\t\t\t\tshadow: {\r\n\t\t\t\t\tleft: 5,\t// shadow left offset\r\n\t\t\t\t\ttop: 15,\t// shadow top offset\r\n\t\t\t\t\talpha: 0.02\t// shadow alpha\r\n\t\t\t\t},\r\n\t\t\t\toffset: {\r\n\t\t\t\t\ttop: 0,\r\n\t\t\t\t\tleft: \"auto\"\r\n\t\t\t\t},\r\n\t\t\t\tstroke: {\r\n\t\t\t\t\tcolor: \"#fff\",\r\n\t\t\t\t\twidth: 1\r\n\t\t\t\t},\r\n\t\t\t\tlabel: {\r\n\t\t\t\t\tshow: \"auto\",\r\n\t\t\t\t\tformatter: function(label, slice) {\r\n\t\t\t\t\t\treturn \"<div style='font-size:x-small;text-align:center;padding:2px;color:\" + slice.color + \";'>\" + label + \"<br/>\" + Math.round(slice.percent) + \"%</div>\";\r\n\t\t\t\t\t},\t// formatter function\r\n\t\t\t\t\tradius: 1,\t// radius at which to place the labels (based on full calculated radius if <=1, or hard pixel value)\r\n\t\t\t\t\tbackground: {\r\n\t\t\t\t\t\tcolor: null,\r\n\t\t\t\t\t\topacity: 0\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreshold: 0\t// percentage at which to hide the label (i.e. the slice is too narrow)\r\n\t\t\t\t},\r\n\t\t\t\tcombine: {\r\n\t\t\t\t\tthreshold: -1,\t// percentage at which to combine little slices into one larger slice\r\n\t\t\t\t\tcolor: null,\t// color to give the new slice (auto-generated if null)\r\n\t\t\t\t\tlabel: \"Other\"\t// label to give the new slice\r\n\t\t\t\t},\r\n\t\t\t\thighlight: {\r\n\t\t\t\t\t//color: \"#fff\",\t\t// will add this functionality once parseColor is available\r\n\t\t\t\t\topacity: 0.5\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t$.plot.plugins.push({\r\n\t\tinit: init,\r\n\t\toptions: options,\r\n\t\tname: \"pie\",\r\n\t\tversion: \"1.1\"\r\n\t});\r\n\r\n})(jQuery);\r\n"]}