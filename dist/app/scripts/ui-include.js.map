{"version":3,"sources":["../../../server/app/scripts/ui-include.js"],"names":["$","promise","deferred","Deferred","_","templateSettings","interpolate","fn","uiInclude","compile","node","find","each","that","url","attr","then","request","ajax","eval","method","dataType","chained","text","compiled","template","toString","html","app","ui","replaceWithPush","uiJp","length","resolve","o","$o","replaceWith","jQuery"],"mappings":";;AAAA,CAAC,UAAUA,CAAV,EAAa;AACX;;AAEF,KAAIC,UAAU,KAAd;AAAA,KACCC,WAAWF,EAAEG,QAAF,EADZ;AAEAC,GAAEC,gBAAF,CAAmBC,WAAnB,GAAiC,iBAAjC;AACAN,GAAEO,EAAF,CAAKC,SAAL,GAAiB,YAAU;AAC1B,MAAG,CAACP,OAAJ,EAAY;AACXA,aAAUC,SAASD,OAAT,EAAV;AACA;AACD;;AAEAQ,UAAQ,IAAR;;AAEA,WAASA,OAAT,CAAiBC,IAAjB,EAAsB;AACrBA,QAAKC,IAAL,CAAU,cAAV,EAA0BC,IAA1B,CAA+B,YAAU;AACxC,QAAIC,OAAOb,EAAE,IAAF,CAAX;AAAA,QACCc,MAAOD,KAAKE,IAAL,CAAU,YAAV,CADR;AAEAd,cAAUA,QAAQe,IAAR,CACT,YAAU;AACT;AACA,SAAIC,UAAUjB,EAAEkB,IAAF,CAAO;AACpBJ,WAAKK,KAAKL,GAAL,CADe;AAEpBM,cAAQ,KAFY;AAGpBC,gBAAU;AAHU,MAAP,CAAd;AAKA;AACA,SAAIC,UAAUL,QAAQD,IAAR,CACb,UAASO,IAAT,EAAc;AACb;AACA,UAAIC,WAAWpB,EAAEqB,QAAF,CAAWF,KAAKG,QAAL,EAAX,CAAf;AACA,UAAIC,OAAOH,SAAS,EAACI,KAAKA,GAAN,EAAT,CAAX;AACA,UAAIC,KAAKhB,KAAKiB,eAAL,CAAsBH,IAAtB,CAAT;AACGE,SAAGlB,IAAH,CAAQ,SAAR,EAAmBoB,IAAnB;AACHF,SAAGlB,IAAH,CAAQ,cAAR,EAAwBqB,MAAxB,IAAkCvB,QAAQoB,EAAR,CAAlC;AACA,MARY,CAAd;AAUA,YAAOP,OAAP;AACA,KApBQ,CAAV;AAsBA,IAzBD;AA0BA;;AAEDpB,WAAS+B,OAAT;AACA,SAAOhC,OAAP;AACA,EAvCD;;AAyCAD,GAAEO,EAAF,CAAKuB,eAAL,GAAuB,UAASI,CAAT,EAAY;AAC/B,MAAIC,KAAKnC,EAAEkC,CAAF,CAAT;AACA,OAAKE,WAAL,CAAiBD,EAAjB;AACA,SAAOA,EAAP;AACH,EAJD;AAMA,CArDD,EAqDGE,MArDH","file":"ui-include.js","sourcesContent":["(function ($) {\r\n  \t\"use strict\";\r\n  \t\r\n\tvar promise = false,\r\n\t\tdeferred = $.Deferred();\r\n\t_.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\r\n\t$.fn.uiInclude = function(){\r\n\t\tif(!promise){\r\n\t\t\tpromise = deferred.promise();\r\n\t\t}\r\n\t\t//console.log('start: includes');\r\n\t\t\r\n\t\tcompile(this);\r\n\r\n\t\tfunction compile(node){\r\n\t\t\tnode.find('[ui-include]').each(function(){\r\n\t\t\t\tvar that = $(this),\r\n\t\t\t\t\turl  = that.attr('ui-include');\r\n\t\t\t\tpromise = promise.then( \r\n\t\t\t\t\tfunction(){\r\n\t\t\t\t\t\t//console.log('start: compile '+ url);\r\n\t\t\t\t\t\tvar request = $.ajax({\r\n\t\t\t\t\t\t\turl: eval(url),\r\n\t\t\t\t\t\t\tmethod: \"GET\",\r\n\t\t\t\t\t\t\tdataType: \"text\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//console.log('start: loading '+ url);\r\n\t\t\t\t\t\tvar chained = request.then(\r\n\t\t\t\t\t\t\tfunction(text){\r\n\t\t\t\t\t\t\t\t//console.log('done: loading '+ url);\r\n\t\t\t\t\t\t\t\tvar compiled = _.template(text.toString());\r\n\t\t\t\t\t\t\t\tvar html = compiled({app: app});\r\n\t\t\t\t\t\t\t\tvar ui = that.replaceWithPush( html );\r\n\t\t\t\t    \t\t\tui.find('[ui-jp]').uiJp();\r\n\t\t\t\t\t\t\t\tui.find('[ui-include]').length && compile(ui);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\treturn chained;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tdeferred.resolve();\r\n\t\treturn promise;\r\n\t}\r\n\r\n\t$.fn.replaceWithPush = function(o) {\r\n\t    var $o = $(o);\r\n\t    this.replaceWith($o);\r\n\t    return $o;\r\n\t}\r\n\r\n})(jQuery);\r\n"]}